!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.Zooming=e()}(this,function(){"use strict";var n="WebkitAppearance"in document.documentElement.style?"-webkit-":"",e={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(.4,0,0,1)",bgColor:"#fff",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onGrab:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},t=function(n){var e={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==n.style[t])return e.transitionProp=t,e.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==n.style[t])return e.transformProp=t,e.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),e},o=function(n,e){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[n]=i),o.transform&&(i=o.transform,delete o.transform,o[e]=i);var a=t.style,s={};for(var l in o)r&&(s[l]=a[l]||""),a[l]=o[l];return s}},r=function(n,e,t){for(var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=e.length;r--;){var i=e[r];o?n.addEventListener(i,t[i]):n.removeEventListener(i,t[i])}},i=function(n){return(new Image).src=n},a=void 0,s=200,l=2,u=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],c=document.body,d=document.createElement("div"),f=void 0,m=void 0,v=!1,p=!1,g=!1,b=!1,h=!1,y=null,w=void 0,E=void 0,T=void 0,x=void 0,L=void 0,k={close:null,open:null},C=t(d),B=C.transformCssProp,G=C.transEndEvent,A=o(C.transitionProp,C.transformProp),z=function(n,e,t){return A(n,e,t)},D=function(){var n=f.getBoundingClientRect(),t=n.width/2,o=n.height/2,r={x:n.left+t,y:n.top+o},i={x:window.innerWidth/2,y:window.innerHeight/2},a={x:i.x-t,y:i.y-o},s=a.x/t,l=a.y/o;return w={x:i.x-r.x,y:i.y-r.y},E=e.scaleBase+Math.min(s,l),"translate("+w.x+"px, "+w.y+"px) scale("+E+")"},O=function(n,e){var t=n.length;h=t>1;for(var o=n.length,r=0,i=0,a=n[0].clientX,s=n[0].clientY,u=n[0].clientX,c=n[0].clientY;o--;){var d=n[o],f=d.clientX,m=d.clientY;r+=f,i+=m,h&&(f<a?a=f:f>u&&(u=f),m<s?s=m:m>c&&(c=m))}if(h){var v=u-a,p=c-s;L=v>p?v/window.innerWidth*l:p/window.innerHeight*l}e(r/n.length,i/n.length)},I={scroll:function(){var n=window.pageYOffset||(document.documentElement||c.parentNode||c).scrollTop;null===y&&(y=n);var t=y-n;Math.abs(t)>=e.scrollThreshold&&(y=null,P.close())},keydown:function(n){var e=n.key||n.code;"Escape"!==e&&27!==n.keyCode||P.close()},mousedown:function(n){n.preventDefault(),x=setTimeout(function(){g=!0,P.grab(n.clientX,n.clientY,!0)},s)},mousemove:function(n){g&&P.grab(n.clientX,n.clientY)},mouseup:function(){clearTimeout(x),g=!1,b?P.release():P.close()},touchstart:function(n){n.preventDefault(),x=setTimeout(function(){g=!0,O(n.touches,function(n,e){return P.grab(n,e,!0)})},s)},touchmove:function(n){g&&O(n.touches,function(n,e){return P.grab(n,e)})},touchend:function(n){0===n.targetTouches.length&&(clearTimeout(x),g=!1,b?P.release():P.close())}},P={listen:function(t){if("string"==typeof t){for(var o=document.querySelectorAll(t),r=o.length;r--;)P.listen(o[r]);return a}if("IMG"===t.tagName)return t.style.cursor=n+"zoom-in",t.addEventListener("click",function(n){n.preventDefault(),v||P.open(t)}),e.preloadImage&&t.hasAttribute("data-original")&&i(t.getAttribute("data-original")),a},config:function(n){if(!n)return e;for(var t in n)e[t]=n[t];return z(d,{backgroundColor:e.bgColor,transition:"opacity\n        "+e.transitionDuration+"s\n        "+e.transitionTimingFunction}),a},open:function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.onOpen;if(!v&&!p&&(f="string"==typeof t?document.querySelector(t):t,"IMG"===f.tagName))return e.onBeforeOpen&&e.onBeforeOpen(f),v=!0,p=!0,m=f.parentNode,f.offsetWidth,k.open={position:"relative",zIndex:999,cursor:""+n+(e.enableGrab?"grab":"zoom-out"),transition:B+"\n        "+e.transitionDuration+"s\n        "+e.transitionTimingFunction,transform:D()},k.close=z(f,k.open,!0),m.appendChild(d),setTimeout(function(){return d.style.opacity=e.bgOpacity},30),document.addEventListener("scroll",I.scroll),document.addEventListener("keydown",I.keydown),f.addEventListener(G,function n(){f.removeEventListener(G,n),e.enableGrab&&r(f,u,I,!0),p=!1,f.hasAttribute("data-original")&&(T=f.getAttribute("src"),f.setAttribute("src",f.getAttribute("data-original"))),o&&o(f)}),a},close:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.onClose;if(v&&!p)return p=!0,e.onBeforeClose&&e.onBeforeClose(f),f.offsetWidth,d.style.opacity=0,z(f,{transform:"none"}),document.removeEventListener("scroll",I.scroll),document.removeEventListener("keydown",I.keydown),f.addEventListener(G,function t(){f.removeEventListener(G,t),e.enableGrab&&r(f,u,I,!1),v=!1,p=!1,f.hasAttribute("data-original")&&f.setAttribute("src",T),z(f,k.close),m.removeChild(d),n&&n(f)}),a},grab:function(n,t,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.onGrab;if(v&&!p){b=!0,e.onBeforeGrab&&e.onBeforeGrab(f);var i=window.innerWidth/2-n,a=window.innerHeight/2-t,s=h?L:e.scaleExtra,l=f.style.transform.replace(/translate\(.*?\)/i,"translate("+(w.x+i)+"px, "+(w.y+a)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(E+s)+")");z(f,{cursor:"move",transition:B+" "+(o?e.transitionDuration+"s "+e.transitionTimingFunction:"ease"),transform:l}),f.addEventListener(G,function n(){f.removeEventListener(G,n),r&&r(f)})}},release:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.onRelease;if(v&&!p&&b)return e.onBeforeRelease&&e.onBeforeRelease(f),z(f,k.open),f.addEventListener(G,function e(){f.removeEventListener(G,e),b=!1,n&&n(f)}),a}};return z(d,{zIndex:998,background:e.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n    "+e.transitionDuration+"s\n    "+e.transitionTimingFunction}),d.addEventListener("click",function(){return P.close()}),document.addEventListener("DOMContentLoaded",function(){return P.listen(e.defaultZoomable)}),P});
//# sourceMappingURL=zooming.min.js.map
