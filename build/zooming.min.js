!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Zooming=n()}(this,function(){"use strict";var e="WebkitAppearance"in document.documentElement.style?"-webkit-":"",n=function(e){return function(n){return n/e}},t=n(2),o=function(e){return(new Image).src=e},r=function(){var e=document.body;return window.pageYOffset||(document.documentElement||e.parentNode||e).scrollTop},i=function(){return{x:t(window.innerWidth),y:t(window.innerHeight)}},a=function(e,n,t){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];n.forEach(function(n){o?e.addEventListener(n,t[n]):e.removeEventListener(n,t[n])})},s=200,u=2,l=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],c={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeRelease:null},d={target:{close:null,open:null},overlay:{init:{zIndex:998,backgroundColor:c.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+c.transitionDuration+"s\n        "+c.transitionTimingFunction}},cursor:{default:"auto",zoomIn:e+"zoom-in",zoomOut:e+"zoom-out",grab:e+"grab",move:"move"}},f=function(e){var n={},t=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],r={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return t.some(function(t){if(void 0!==e.style[t])return n.transitionProp=t,n.transEndEvent=r[t],!0}),o.some(function(t){if(void 0!==e.style[t])return n.transformProp=t,n.transformCssProp=t.replace(/(.*)Transform/,"-$1-transform"),!0}),n},m=function(e,n){return function(t,o,r){var i=void 0;o.transition&&(i=o.transition,delete o.transition,o[e]=i),o.transform&&(i=o.transform,delete o.transform,o[n]=i);var a=t.style,s={};for(var u in o)r&&(s[u]=a[u]||""),a[u]=o[u];return s}},v=function(e){var n=i(),o={x:e.left+t(e.width),y:e.top+t(e.height)};return{x:n.x-o.x,y:n.y-o.y}},g=function(e,n){var o=i(),r=t(e.width),a=t(e.height),s={x:o.x-r,y:o.y-a},u=s.x/r,l=s.y/a;return n+Math.min(u,l)},p=function(e,n){for(var t=e.length,o=e[0],r=t>1,i=void 0,a=e.length,s=0,l=0,c={x:o.clientX,y:o.clientY},d={x:o.clientX,y:o.clientY};a--;){var f=e[a],m=[f.clientX,f.clientY],v=m[0],g=m[1];s+=v,l+=g,r&&(v<c.x?c.x=v:v>d.x&&(d.x=v),g<c.y?c.y=g:g>d.y&&(d.y=g))}if(r){var p=d.x-c.x,y=d.y-c.y;i=p>y?p/window.innerWidth*u:y/window.innerHeight*u}n(s/t,l/t,r,i)},y=void 0,b=document.body,h=document.createElement("div"),x=void 0,E=void 0,w=!1,T=!1,L=!0,k=!1,C=null,B=void 0,z=void 0,A=void 0,O=void 0,D=void 0,G=f(h),I=G.transformCssProp,P=G.transEndEvent,R=m(G.transitionProp,G.transformProp),Y=function(e,n,t){return R(e,n,t)},F={scroll:function(){var e=r();null===C&&(C=e);var n=C-e;Math.abs(n)>=c.scrollThreshold&&(C=null,M.close())},keydown:function(e){var n=e.key||e.code;"Escape"!==n&&27!==e.keyCode||M.close()},mousedown:function(e){e.preventDefault(),O=setTimeout(function(){M.grab(e.clientX,e.clientY,!0)},s)},mousemove:function(e){L||M.grab(e.clientX,e.clientY)},mouseup:function(){clearTimeout(O),L?M.close():M.release()},touchstart:function(e){e.preventDefault(),O=setTimeout(function(){p(e.touches,function(e,n,t,o){k=t,D=o,M.grab(e,n,!0)})},s)},touchmove:function(e){L||p(e.touches,function(e,n,t,o){k=t,D=o,M.grab(e,n)})},touchend:function(e){e.targetTouches.length>0||(clearTimeout(O),L?M.close():M.release())}},M={listen:function(e){if("string"==typeof e){for(var n=document.querySelectorAll(e),t=n.length;t--;)M.listen(n[t]);return y}if("IMG"===e.tagName)return e.style.cursor=d.cursor.zoomIn,e.addEventListener("click",function(n){n.preventDefault(),w?L?M.close():M.release():M.open(e)}),c.preloadImage&&e.hasAttribute("data-original")&&o(e.getAttribute("data-original")),y},config:function(e){if(!e)return c;for(var n in e)c[n]=e[n];return Y(h,{backgroundColor:c.bgColor,transition:"opacity\n        "+c.transitionDuration+"s\n        "+c.transitionTimingFunction}),y},open:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.onOpen;if(!w&&!T&&(x="string"==typeof e?document.querySelector(e):e,"IMG"===x.tagName)){c.onBeforeOpen&&c.onBeforeOpen(x),w=!0,T=!0,E=x.parentNode;var t=x.getBoundingClientRect();return B=v(t),z=g(t,c.scaleBase),x.offsetWidth,d.target.open={position:"relative",zIndex:999,cursor:c.enableGrab?d.cursor.grab:d.cursor.zoomOut,transition:I+"\n        "+c.transitionDuration+"s\n        "+c.transitionTimingFunction,transform:"translate("+B.x+"px, "+B.y+"px) scale("+z+")"},d.target.close=Y(x,d.target.open,!0),E.appendChild(h),setTimeout(function(){return h.style.opacity=c.bgOpacity},30),document.addEventListener("scroll",F.scroll),document.addEventListener("keydown",F.keydown),x.addEventListener(P,function e(){x.removeEventListener(P,e),c.enableGrab&&a(document,l,F,!0),T=!1,x.hasAttribute("data-original")&&(A=x.getAttribute("src"),x.setAttribute("src",x.getAttribute("data-original"))),n&&n(x)}),y}},close:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.onClose;if(w&&!T)return T=!0,c.onBeforeClose&&c.onBeforeClose(x),x.offsetWidth,b.style.cursor=d.cursor.default,h.style.opacity=0,Y(x,{transform:"none"}),document.removeEventListener("scroll",F.scroll),document.removeEventListener("keydown",F.keydown),x.addEventListener(P,function n(){x.removeEventListener(P,n),c.enableGrab&&a(document,l,F,!1),w=!1,T=!1,x.hasAttribute("data-original")&&x.setAttribute("src",A),Y(x,d.target.close),E.removeChild(h),e&&e(x)}),y},grab:function(e,n,t,o){if(w&&!T){L=!1,c.onBeforeGrab&&c.onBeforeGrab(x);var r=i(),a=r.x-e,s=r.y-n,u=k?D:c.scaleExtra,l=x.style.transform.replace(/translate\(.*?\)/i,"translate("+(B.x+a)+"px, "+(B.y+s)+"px)").replace(/scale\([0-9|\.]*\)/i,"scale("+(z+u)+")");Y(x,{cursor:d.cursor.move,transition:I+" "+(t?c.transitionDuration+"s "+c.transitionTimingFunction:"ease"),transform:l}),b.style.cursor=d.cursor.move,x.addEventListener(P,function e(){x.removeEventListener(P,e),o&&o(x)})}},release:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.onRelease;if(w&&!T)return T=!0,c.onBeforeRelease&&c.onBeforeRelease(x),Y(x,d.target.open),b.style.cursor=d.cursor.default,x.addEventListener(P,function n(){x.removeEventListener(P,n),T=!1,L=!0,e&&e(x)}),y}};return Y(h,d.overlay.init),h.setAttribute("id","zoom-overlay"),h.addEventListener("click",function(){return M.close()}),document.addEventListener("DOMContentLoaded",function(){return M.listen(c.defaultZoomable)}),M});
//# sourceMappingURL=zooming.min.js.map
